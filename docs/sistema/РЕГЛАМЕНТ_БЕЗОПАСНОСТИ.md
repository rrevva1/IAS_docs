# Регламент безопасности (минимальный объём для MVP)

## 1. Аутентификация и учётные данные

- Пароли хранятся в виде хеша (Yii2 Security, bcrypt). Пароли не выводятся в логи и не отображаются в интерфейсе.
- Тестовые экшены (сброс пароля в открытом виде, тест хешей, тестовые страницы) отключены или доступны только администратору; сброс пароля администратором фиксируется в журнале аудита.

## 2. Разграничение доступа

- Все операции с заявками, вложениями и учётом ТС проверяются на сервере (метод canUserAccessTask, проверка роли, проверка ответственного за актив).
- Скачивание и предпросмотр вложений разрешены только при наличии доступа к заявке, к которой привязано вложение.
- Перечень техники пользователя (get-user-equipment) выдаётся только для текущего пользователя или при роли администратор/оператор.

## 3. Защита от XSS и опасных типов файлов

- Предпросмотр вложений: для типов, отнесённых к опасным (в том числе SVG), не используется режим inline — только скачивание.
- Для ответов с файлом устанавливается заголовок `X-Content-Type-Options: nosniff`.

## 4. Журнал аудита

- Фиксируются операции: сброс пароля, удаление заявки, удаление вложения, создание/обновление заявки, создание/обновление оборудования.
- Записи журнала аудита неизменяемы (триггер на уровне БД в целевой схеме create_ias_vniic.sql).
