# Импорт из «Основного учёта» (ОУ)

Парсинг листа АРМ (ОУ_тест.xlsx / Основной Учет.xlsx), регламент, ETL и примеры.

**Единый источник правил:** регламент; при расхождении приоритет у регламента.

| Документ | Описание |
|----------|----------|
| [РЕГЛАМЕНТ_ПАРСИНГА_ОУ_ТЕСТ.md](РЕГЛАМЕНТ_ПАРСИНГА_ОУ_ТЕСТ.md) | Правила парсинга по столбцам, особым значениям, листу Принтеры. |
| [ОУ_ТЕСТ_ПАРСИНГ_ETL_И_ИНСТРУМЕНТЫ.md](ОУ_ТЕСТ_ПАРСИНГ_ETL_И_ИНСТРУМЕНТЫ.md) | Структура источника, ETL-диаграмма, инструменты (Python/PHP). |
| [ОУ_ТЕСТ_ПЕРВЫЕ_10_СТРОК_ПАРСИНГ.md](ОУ_ТЕСТ_ПЕРВЫЕ_10_СТРОК_ПАРСИНГ.md) | Примеры: первые 10 строк — атомарные значения и маппинг в БД. |

### Скрипты загрузки в БД

| Скрипт | Назначение |
|--------|------------|
| `scripts/load_ou_test_20rows.py` | Тестовая загрузка первых 20 строк листа АРМ из ОУ_тест.xlsx. |
| `scripts/load_ou_main.py` | Полная загрузка листов **АРМ** и **Принтеры** из файла «Основной Учет.xlsx» в БД (схема tech_accounting). По регламенту: отдельные записи equipment на мониторы (МЦ.04-mon-XXX) и ИБП (МЦ.04-ups-XXX); при существующем инв. номере — обновление записи. |

**Запуск полной загрузки:** поместите «Основной Учет.xlsx» в корень проекта (или задайте `OU_MAIN_EXCEL=/путь/к/файлу.xlsx`), установите зависимости (`pip install openpyxl psycopg2-binary` или используйте venv) и выполните:  
`python3 scripts/load_ou_main.py`
