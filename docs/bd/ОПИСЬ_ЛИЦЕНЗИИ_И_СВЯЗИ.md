# Что попадает куда: лицензии, оборудование, комплектующие

## 1. К чему привязываются лицензии

**Лицензия** в системе привязана к **программному обеспечению (ПО)**, а не к «компьютеру» напрямую.

- Таблица **`licenses`**: поля `software_id`, `valid_until`, `notes`. Связь: лицензия → **одно** ПО (`software`).
- Таблица **`software`**: справочник наименований ПО (name, version).

То есть лицензия отвечает на вопрос: «на какое ПО действует и до какой даты».

## 2. Где «компьютер пользователя»

**Компьютер пользователя** в учёте — это **актив (единица техники)**: таблица **`equipment`**.

- У актива есть: инв. номер, название, тип техники, ответственный пользователь, локация, статус и т.д.
- Один актив может быть «системным блоком», «ноутбуком», «монитором» и т.п. (поле `equipment_type` или тип из справочников).

То есть «компьютер» = запись в `equipment` (одна единица техники).

## 3. Компьютер как набор составляющих частей

Составляющие части (комплектующие) описываются через справочники и значения характеристик:

- **`spr_parts`** (типы частей) — например: ЦП, ОЗУ, Накопитель, Монитор, ПК.
- **`spr_chars`** (характеристики) — например: Модель, Объём, № монитора, Имя ПК, IP адрес, ОС, Антивирус.
- **`part_char_values`** — значения характеристик **по конкретному активу**: для каждого `equipment_id` хранятся пары (тип части + характеристика) и значение (текст или число).

Таким образом, **один актив (equipment)** может иметь много строк в `part_char_values`: по каждой комбинации (тип части, характеристика) — своё значение (например, ЦП — модель, ОЗУ — объём, Монитор — модель и т.д.). То есть «компьютер» = один актив + набор заполненных характеристик из `part_char_values` (связь с `spr_parts` и `spr_chars`).

## 4. Связь «ПО — актив (компьютер)»

Установленное на активе ПО учитывается в таблице **`equipment_software`**:

- `equipment_id` — актив (тот самый «компьютер»),
- `software_id` — наименование ПО из справочника `software`,
- при необходимости — дата установки и т.п.

Итоговая цепочка:

- **Лицензия** → привязана к **ПО** (`software`).
- **ПО** может быть установлено на **активах** через **`equipment_software`**.
- **Актив** (`equipment`) описывается как набор составляющих через **`part_char_values`** (типы частей из `spr_parts`, характеристики из `spr_chars`).

То есть: лицензия не привязана к «комплектующим» и не к активу напрямую; она привязана к ПО; связь «на каком компьютере (активе) стоит это ПО» даёт таблица `equipment_software`.

## 5. Краткая опись: что куда попадает

| Что | Куда попадает | Таблица / сущность |
|-----|----------------|---------------------|
| Наименование ПО | Справочник ПО | `software` |
| Срок действия лицензии по ПО | Учёт лицензий | `licenses` (связь с `software`) |
| Единица техники (компьютер, монитор и т.д.) | Учёт ТС | `equipment` |
| Факт «на этом активе установлено такое-то ПО» | Установленное ПО | `equipment_software` (equipment_id + software_id) |
| Типы частей (ЦП, ОЗУ, Монитор …) | Справочники | `spr_parts` |
| Наименования характеристик (Модель, Объём, ОС …) | Справочники | `spr_chars` |
| Конкретные значения характеристик по активу | Характеристики актива | `part_char_values` (equipment_id + part_id + char_id + value) |
| События аудита | Журнал аудита | `audit_events` |

Данные из **Основного учёта (ОУ)** при импорте заполняют в первую очередь: активы (`equipment`), при необходимости — справочники типов частей и характеристик и значения в `part_char_values`. Тестовые данные по аудиту, ПО и лицензиям в дампе **не** загружаются из ОУ; для них используются скрипты из папки `tests/` (см. `tests/LOAD_TEST_DATA_FROM_DUMP.md`).
