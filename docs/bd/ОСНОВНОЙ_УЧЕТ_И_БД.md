# Достаточность БД для учёта «Основной учёт» (предприятие)

Документ отвечает на вопрос: **достаточно ли схемы БД проекта, чтобы вместить учёт, ведущийся на предприятии в рамках «Основного учёта»** (файл «Основной Учет.xlsx», лист «АРМ» и связанные данные).

---

## 1. Что входит в «Основной учёт» (лист АРМ)

По документу `docs/СТРУКТУРА_ЛИСТА_АРМ_ОСНОВНОЙ_УЧЕТ.md` лист **АРМ** содержит:

| Столбец | Данные | Примеры |
|--------|--------|---------|
| A | Наименование / тип техники | Системный блок, Ноутбук, Монитор, Моноблок, ИБП, Коммутатор |
| B | Поставщик | ООО "ГКС", ООО "Мира", Flextron |
| C | Дата поступления | — |
| D | Кому поставили | ФИО, «к. 508» |
| E | Дата | — |
| F | Примечание | «Списать», «На складе» |
| G | Системный блок | Модель/описание СБ |
| H | ЦП | Core i5-7400 3,0 ГГц, Core i7-9700 |
| I | ОЗУ | 4 ГБ, 8 ГБ, 16 ГБ |
| J | Диск / накопители | 500 ГБ, SSD 240 ГБ, 80 ГБ\n2 ТБ |
| K | Монитор | Модель, возможно несколько в одной ячейке |
| L | Пользователь | ФИО ответственного |
| M | Отдел | Подразделение |
| N | № монитора | Инв. номер монитора |
| O | № системн. блока | Инв. номер СБ |
| P | Инв. Номер | 00-000257, 99036, РБК6930 |
| Q | ОС | Win10 Pro (x64), Astra Linux |
| R | IP адрес | 10.2.2.47 |
| S | Имя | Имя ПК в сети (hostname) |
| T | Антивирус | KES, Kaspersky |
| U | Помещение | Кабинет: 505, 508, к. 702а |
| V–W | Доп. поля | Примечания, статусы |

В книге есть и другие листы (Принтеры; Поставки по годам; СБ/Принтеры/Мониторы забрали). Ниже сопоставление сделано в первую очередь для **листа АРМ** как ядра учёта АРМ.

---

## 2. Какая схема БД используется в проекте

| БД и схема | Файл | Назначение |
|------------|------|------------|
| **ias_vniic / tech_accounting** | `scripts/create_ias_vniic.sql` (DDL), `db/IAS_VNIIC_dump.sql` (дамп) | Целевая схема для эксплуатации и импорта из «Основного учета»: инв. номер, тип техники, поставщик, даты, статусы, связь заявок с активами, вложения, аудит |

---

## 3. Сопоставление: Основной учёт → БД

### 3.1. Таблица equipment (актив / единица учёта)

| Данные Основного учёта | ias_vniic (tech_accounting) |
|------------------------|-----------------------------|
| Инв. номер (P, O, N) | **inventory_number** (NOT NULL, UNIQUE) |
| Серийный номер | **serial_number** (опционально, UNIQUE) |
| Наименование / тип техники (A, G) | **name** + **equipment_type** (Системный блок, Ноутбук, Монитор…) |
| Пользователь / ответственный (L) | **responsible_user_id** |
| Помещение (U) | **location_id** |
| Примечание, статусы (F) | **description** + **status_id** (справочник статусов) |
| Поставщик (B) | **supplier** |
| Дата поступления (C), даты (E) | **purchase_date**, **commissioning_date** |
| Гарантия | **warranty_until** |
| № монитора (N) для строки «Монитор» | **part_char_values** (тип части «Монитор», характеристика «Инв. номер») или description |

**Вывод по equipment:** схема ias_vniic (tech_accounting) вмещает все перечисленные данные Основного учёта по листу АРМ в структурированном виде.

### 3.2. Пользователи и отдел

| Данные Основного учёта | ias_vniic (tech_accounting) |
|------------------------|----------------|
| Пользователь (L) — ФИО | **users.full_name**, связь equipment → users |
| Отдел (M) | **users.department** (отдел привязан к пользователю, не к строке оборудования) |

Достаточно в любой из схем: есть таблица **users** с полем **department**.

### 3.3. Локации (помещения)

| Данные Основного учёта | ias_vniic (tech_accounting) |
|------------------------|----------------|
| Помещение (U) — кабинет | **locations** (name, location_type: кабинет/склад/серверная/лаборатория/другое, floor, description) |

Достаточно в любой из схем.

### 3.4. Конфигурация ПК (ЦП, ОЗУ, Диск, Монитор, ОС, IP, Имя, Антивирус)

| Данные Основного учёта | ias_vniic (tech_accounting) |
|------------------------|----------------|
| ЦП (H), ОЗУ (I), Диск (J), Монитор (K), ОС (Q), IP (R), Имя (S), Антивирус (T) | **spr_parts** (типы частей: Процессор, ОЗУ, Жесткий диск, Монитор и т.д.) + **spr_chars** (Модель, Объём, Тип памяти, …) + **part_char_values** (equipment_id, part_id, char_id, value_text [и value_num в целевой]) |

Одна запись equipment = один инв. номер (системный блок/ноутбук/моноблок и т.д.). Конфигурация этого ПК хранится множеством строк в **part_char_values** с одним и тем же equipment_id. Неатомарные ячейки (несколько дисков, два монитора) можно сохранять как один value_text или несколько записей part_char_values по регламенту загрузки (см. `docs/СТРУКТУРА_ЛИСТА_АРМ_ОСНОВНОЙ_УЧЕТ.md`).

**Вывод:** для конфигурации ПК схема ias_vniic (tech_accounting) достаточна; дополнительно есть **value_num** для числовых характеристик.

### 3.5. История (дата поступления, перемещения)

| Данные Основного учёта | ias_vniic (tech_accounting) |
|------------------------|-----------------------------|
| Дата поступления (C), дата (E) | **equipment.purchase_date**, **equipment.commissioning_date**; при необходимости дублировать события в **equip_history** (event_type «create» или аналог). |

Для явного хранения дат поступления и ввода в эксплуатацию схема ias_vniic (tech_accounting) достаточна.

### 3.6. Справочники

- **spr_parts** — типы составных частей (Процессор, ОЗУ, Жесткий диск, Монитор, ИБП и т.д.).
- **spr_chars** — типы характеристик (Модель, Производитель, Объём, Тип памяти, Тип накопителя, Разрешение и т.д.).
- **dic_equipment_status** — статусы оборудования: в эксплуатации, на складе, списан и т.д.

---

## 4. Итоговый вывод: достаточно ли БД

| Вопрос | Ответ |
|--------|--------|
| **Хватает ли схемы ias_vniic (tech_accounting) для полного отражения Основного учёта по листу АРМ?** | **Да.** Есть: inventory_number, serial_number, equipment_type, status_id, responsible_user_id, location_id, supplier, purchase_date, commissioning_date, warranty_until, description; справочники spr_parts, spr_chars, dic_equipment_status; part_char_values для конфигурации; users (с department), locations; equip_history для истории изменений. |

**Рекомендация:** для учёта, который ведётся на предприятии в рамках «Основного учёта» (лист АРМ), использовать схему **ias_vniic / tech_accounting** из `scripts/create_ias_vniic.sql` (или её миграцию в основную БД проекта).

---

## 5. Дополнительные листы книги «Основной Учет.xlsx»

В книге есть листы: **Принтеры**; **Поставки 2017–2019, 2020, 2021, …**; **СБ забрали**, **Принтеры забрали**, **Мониторы забрали**. В текущей документации детально разобран только лист **АРМ**. Если предприятие считает частью «Основного учёта» также:

- учёт принтеров как отдельных единиц с инв. номерами,
- регистрацию поставок (дата, поставщик, перечень техники),
- фиксацию списания/выбытия («забрали»),

то для этого может понадобиться:

- вести принтеры и мониторы как отдельные записи в **equipment** (с типом «Принтер», «Монитор») и при необходимости связывать их с АРМ через атрибуты или отдельную таблицу связей; и/или
- ввести сущности **поставки** и **списание** (таблицы + связь с equipment).

Это выходит за рамки текущего сопоставления «лист АРМ ↔ БД». Состав и структура таких сущностей могут быть зафиксированы на этапе обследования.
