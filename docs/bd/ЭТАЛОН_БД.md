# Эталон базы данных

Эталоном схемы и данных является дамп с домашней машины (Mac):

**Файл:** `ias_vniic_14_02_26.sql` (в корне проекта).

На этой машине БД должна соответствовать эталону: изначально — как на домашней, далее — плюс изменения по миграциям проекта.

## Приведение текущей БД к эталону

1. Создайте пустую БД (если ещё нет):
   ```bash
   psql -U postgres -d postgres -c "CREATE DATABASE ias_vniic WITH ENCODING 'UTF8' TEMPLATE template0;"
   ```

2. Восстановите дамп:
   ```bash
   psql -U postgres -d ias_vniic -f ias_vniic_14_02_26.sql
   ```
   Либо с указанием пароля (Windows):
   ```cmd
   set PGPASSWORD=12345
   psql -U postgres -h localhost -d ias_vniic -f ias_vniic_14_02_26.sql
   ```

3. После восстановления дампа миграции Yii2 для таблиц `software`, `licenses`, `equipment_software` выполнять не требуется (они уже есть в дампе). При необходимости проверки: `php yii migrate` — возможна ошибка «таблица уже существует», это нормально.

## Дополнительные миграции

Новые миграции в проекте добавляют только то, чего нет в эталоне. Неактуальные миграции удаляются.
