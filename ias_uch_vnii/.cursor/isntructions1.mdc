---
alwaysApply: true
---
---


Инструкции для агента:
1. На поставленные задачи отвечай так, чтобы я мог самостоятельно выполнить все действия по решению.
2. В предлагаемых решениях все расположения и файлы пиши полностью и где они находятся, особенно если не очевидно.
3. В этом проекте мы пройдемся по созданию веб интерфейса, прохождением курсов, выполнения руководства: https://www.yiiframework.com/doc/guide/2.0/ru/
4. Вот пример структуры директорий проекта, которая мне подходит, в этом проекте делай по примеру:

### Структура директорий

```
/var/www/ias_uch_vnii/
├── assets/              # Asset Bundle классы для управления CSS/JS
│   ├── AgGridAsset.php         # Asset для AG Grid таблиц
│   ├── AppAsset.php            # Основной asset приложения
│   ├── LayoutAsset.php         # Asset для layout
│   ├── SiteAsset.php           # Asset для страниц сайта
│   ├── StatisticsAsset.php     # Asset для статистики
│   ├── TasksAsset.php          # Asset для страниц задач
│   ├── TasksIndexAsset.php     # Asset для списка задач
│   └── UsersAsset.php          # Asset для страниц пользователей
├── commands/            # Console команды
│   └── HelloController.php     # Демо команда (из базового шаблона Yii2)
├── config/             # Конфигурационные файлы
│   ├── __autocomplete.php      # Автодополнение для IDE
│   ├── console.php     # Конфигурация консольного приложения
│   ├── db.php          # Настройки подключения к БД
│   ├── params.php      # Параметры приложения
│   ├── test_db.php     # Настройки тестовой БД
│   ├── test.php        # Конфигурация для тестов
│   └── web.php         # Основная конфигурация веб-приложения
├── controllers/        # Контроллеры MVC
│   ├── HelpDeskController.php  # Контроллер Help Desk
│   ├── SiteController.php      # Контроллер главных страниц
│   ├── TasksController.php     # Контроллер заявок (CRUD)
│   └── UsersController.php     # Контроллер пользователей
├── docs/               # Документация проекта
│   ├── README.md                           # Индекс документации
│   ├── СТРУКТУРА_ДОКУМЕНТАЦИИ.txt          # Визуальное дерево структуры
│   ├── guides/                             # Руководства (4 документа)
│   │   ├── QUICKSTART.md                   # Быстрый старт проекта
│   │   ├── STRUCTURE.md                    # Структура проекта
│   │   ├── УЧЕБНЫЙ_README.md               # Полное учебное руководство (3700+ строк)
│   │   └── ШПАРГАЛКА.md                    # Шпаргалка по проекту
│   ├── technical/                          # Техническая документация (7 документов)
│   │   ├── AGGRID_DATE_FILTER_REPORT.md    # Отчет по фильтрам дат AG Grid
│   │   ├── ASSETS_ARCHITECTURE.md          # Архитектура Assets
│   │   ├── ASSETS_DOCUMENTATION.md         # Документация Assets
│   │   ├── ИСПРАВЛЕНИЯ_NAMESPACE.md        # Документация исправлений namespace
│   │   ├── МИГРАЦИЯ_NAMESPACE.md           # Документация миграции namespace
│   │   ├── РЕФАКТОРИНГ_СТРУКТУРЫ_ПРОЕКТА.md # Документация рефакторинга
│   │   └── ФУНКЦИОНАЛЬНОСТЬ_ЗАГРУЗКИ_ФАЙЛОВ.md # Документация загрузки файлов
│   └── reports/                            # Отчеты (9 документов)
│       ├── ОБНОВЛЕНИЕ_ГЛАВНОЙ_СТРАНИЦЫ_ЗАЯВОК.md   # Обновление страницы заявок
│       ├── ОБНОВЛЕНИЕ_ПОЛЬЗОВАТЕЛЬСКОЙ_СТРАНИЦЫ.md # Обновление страницы пользователей
│       ├── ОБНОВЛЕНИЕ_СТИЛЯ_АДМИНИСТРАТИВНЫХ_ФОРМ.md # Обновление стилей форм
│       ├── ОТЧЕТ_КОСМЕТИКА_ПРОЕКТА.md      # Отчет по улучшению UI
│       ├── ОТЧЕТ_ОБНОВЛЕНИЕ_README.md      # Отчет об обновлении документации
│       ├── ОТЧЕТ_РЕОРГАНИЗАЦИЯ_ASSETS.md   # Отчет по реорганизации Assets
│       ├── ОТЧЕТ_РЕФАКТОРИНГ_VIEW_PHP.md   # Отчет по рефакторингу view
│       ├── ОТЧЕТ_СТРУКТУРИРОВАНИЕ_DOCS.md  # Отчет о структурировании документации
│       └── ПРОЕКТ_ОТЧЕТ.md                 # Общий отчет по проекту
├── mail/               # Шаблоны email писем
├── migrations/         # Миграции базы данных (19 файлов)
│   └── m*.php          # Файлы миграций с датами создания
├── models/             # Модели данных (Active Record)
│   ├── entities/       # Entity модели
│   │   ├── DeskAttachments.php # Модель вложений
│   │   ├── Tasks.php           # Модель заявок
│   │   └── Users.php           # Модель пользователей
│   ├── dictionaries/   # Справочники
│   │   ├── DicTaskStatus.php   # Справочник статусов заявок
│   │   └── Roles.php           # Справочник ролей
│   ├── forms/          # Формы для ввода данных
│   │   ├── ContactForm.php     # Форма обратной связи
│   │   └── LoginForm.php       # Форма авторизации
│   └── search/         # Search модели для GridView
│       ├── TasksSearch.php     # Поиск по заявкам
│       └── UsersSearch.php     # Поиск по пользователям
├── node_modules/       # NPM зависимости
├── runtime/            # Временные файлы, логи, кеш
├── tests/              # Тесты приложения
├── vagrant/            # Конфигурация Vagrant
├── vendor/             # Composer зависимости
├── views/              # Представления (View) - шаблоны страниц
│   ├── layouts/        # Шаблоны макетов
│   │   └── main.php    # Основной layout приложения
│   ├── site/           # Страницы сайта
│   │   ├── about.php         # О проекте
│   │   ├── contact.php       # Контакты
│   │   ├── error.php         # Страница ошибки
│   │   ├── index.php         # Главная страница
│   │   ├── login.php         # Авторизация
│   │   ├── rebbe.php         # Тестовая страница
│   │   ├── say.php           # Демо страница
│   │   └── test-auth.php     # Тестирование авторизации
│   ├── tasks/          # Страницы заявок
│   │   ├── _form.php         # Форма заявки
│   │   ├── _search.php       # Форма поиска заявок
│   │   ├── create.php        # Создание заявки
│   │   ├── index.php         # Список заявок (Kartik GridView)
│   │   ├── index-aggrid.php  # Список заявок (AG Grid)
│   │   ├── statistics.php    # Статистика
│   │   ├── update.php        # Редактирование заявки
│   │   └── view.php          # Просмотр заявки
│   └── users/          # Страницы пользователей
│       ├── _form.php         # Форма пользователя
│       ├── _search.php       # Форма поиска пользователей
│       ├── create.php        # Создание пользователя
│       ├── index.php         # Список пользователей (основной)
│       ├── index2.php        # Список пользователей (альтернативный)
│       ├── update.php        # Редактирование пользователя
│       └── view.php          # Просмотр пользователя
├── web/                # Публичная директория (веб-корень)
│   ├── ag-charts-types/      # Типы для AG Charts
│   ├── ag-grid-community/    # Библиотека AG Grid
│   ├── assets/         # Скомпилированные assets (автоген.)
│   ├── css/            # CSS стили (организованы по модулям)
│   │   ├── common/           # Общие стили
│   │   │   └── site.css      # Основные стили сайта
│   │   ├── site/             # Стили для страниц сайта
│   │   │   └── pages.css
│   │   ├── tasks/            # Стили для страниц заявок
│   │   │   ├── ag-grid.css   # Стили для AG Grid таблицы
│   │   │   ├── form.css      # Форма создания/редактирования
│   │   │   ├── form-modal.css # Модальная форма
│   │   │   ├── index.css     # Список заявок
│   │   │   ├── statistics.css # Статистика
│   │   │   └── view.css      # Просмотр заявки
│   │   └── users/            # Стили для пользователей
│   │       └── index.css
│   ├── js/             # JavaScript файлы (организованы по модулям)
│   │   ├── site/             # Скрипты для страниц сайта
│   │   │   └── pages.js
│   │   ├── tasks/            # Скрипты для заявок
│   │   │   ├── ag-grid-init.js # Инициализация AG Grid
│   │   │   ├── ag-grid.js    # Конфигурация AG Grid
│   │   │   ├── form.js       # Логика форм
│   │   │   ├── form-modal.js # Модальная форма
│   │   │   ├── index.js      # Список заявок
│   │   │   ├── statistics.js # Статистика
│   │   │   └── view.js       # Просмотр заявки
│   │   └── users/            # Скрипты для пользователей
│   │       └── index.js
│   ├── layouts/        # Дополнительные layout файлы
│   │   ├── css/              # CSS для layouts
│   │   └── js/               # JS для layouts
│   ├── uploads/        # Загруженные файлы
│   │   └── tasks/      # Файлы вложений заявок
│   ├── favicon.ico     # Иконка сайта
│   ├── index.php       # Точка входа приложения
│   ├── index-test.php  # Тестовая точка входа
│   └── robots.txt      # Правила для поисковых роботов
├── widgets/            # Виджеты Yii2
│   └── Alert.php       # Виджет уведомлений
├── codeception.yml     # Конфигурация Codeception (тесты)
├── composer.json       # PHP зависимости
├── composer.lock       # Зафиксированные версии PHP зависимостей
├── (Docker: папка docker/ в корне репозитория)
├── LICENSE.md          # Лицензия проекта
├── package.json        # NPM зависимости (для AG Grid и др.)
├── package-lock.json   # Зафиксированные версии NPM зависимостей
├── README.md           # Основной README проекта
├── requirements.php    # Проверка требований к серверу
├── Vagrantfile         # Конфигурация Vagrant
├── yii                 # Консольная команда Yii (Linux/Mac)
└── yii.bat             # Консольная команда Yii (Windows)


5. Если будешь создавать файлы, используй следующую структуру для CSS и JS на примере другого проекта (названия соответсвующие stud_pr будут):


web/css/ (актуальная структура)
├── common/          # Общие стили для всего приложения
│   └── site.css     # Базовые стили (layout, footer, формы)
├── site/            # Стили для страниц сайта
│   └── pages.css    # Стили страниц (о нас, контакты и т.д.)
├── tasks/           # Стили для модуля заявок
│   ├── ag-grid.css       # Стили для AG Grid таблицы
│   ├── form.css          # Форма создания/редактирования
│   ├── form-modal.css    # Модальное окно формы
│   ├── index.css         # Список заявок (GridView)
│   ├── statistics.css    # Страница статистики
│   └── view.css          # Детальный просмотр заявки
└── users/           # Стили для модуля пользователей
    └── index.css    # Список и профили пользователей
```

#### Структура JavaScript файлов (актуальная):
```
web/js/
├── site/                # Скрипты для страниц сайта
│   └── pages.js
├── tasks/               # Скрипты для модуля заявок
│   ├── ag-grid-init.js  # Инициализация AG Grid
│   ├── ag-grid.js       # Конфигурация и логика AG Grid
│   ├── form.js          # Логика форм (валидация, загрузка файлов)
│   ├── form-modal.js    # Логика модального окна
│   ├── index.js         # Логика списка заявок
│   ├── statistics.js    # Логика графиков и диаграмм
│   └── view.js          # Логика просмотра заявки
└── users/               # Скрипты для модуля пользователей
    └── index.js


6. Все комментарии оставляй на русском языке.
7. Комментарии вставляй чаще, проект учебный.
8. Если создаешь и используешь скрипты диагностики и логирования, после решения проблемы удаляй их.
9. Все задачи, связанные с исправление или созданием чего-либо в коде, сначала описывай проблему и способ ее решения, а исполнять по запросу от тебя.
10. Документируй события:
- веди README.md проекта (корень), подробно описывающий его
- веди docs/README.md - индекс всей документации
- веди docs/guides/УЧЕБНЫЙ_README.md - полное учебное руководство (3700+ строк)
- веди docs/guides/STRUCTURE.md - структуру проекта
- создавай отчеты в docs/reports/ о выполненных работах
- создавай техническую документацию в docs/technical/ для сложных решений
- обновляй эти документы после внесений изменений в проекте, чтобы они всегда были актуальными
- комментируй больше, чтобы новичку все было понятно

Структура документации:
- docs/guides/ - руководства и обучающие материалы
- docs/technical/ - техническая документация и архитектурные решения
- docs/reports/ - отчеты о выполненных работах и изменениях

В корне кроме README.md, никаких отчетов и сводок не должно быть.

11. Соблюдай стандарты именования Yii2:
- Классы: PascalCase (TasksController, UserProfile, AppAsset)
- Методы/свойства: camelCase (actionIndex, getUserName, isActive)
- Методы контроллера: action + CamelCase (actionCreate, actionView, actionDelete)
- Приватные свойства: _camelCase с подчеркиванием ($_user, $_config)
- Константы: UPPER_CASE (MAX_USERS, DEFAULT_ROLE)
- Таблицы БД: snake_case множественное число (users, task_statuses, desk_attachments)
- Поля БД: snake_case (user_id, created_at, is_active)

12. Используй стандартные методы обработки ошибок Yii2:
- Встроенный ErrorHandler с ErrorAction в SiteController для глобальных ошибок
- Валидация моделей через rules() и validate() - основной метод проверки данных
- Flash-сообщения Yii::$app->session->setFlash() для уведомлений пользователей
- Логирование: Yii::error(), Yii::warning(), Yii::info() - записывается в runtime/logs/
- Try-catch только для критических операций (транзакции БД, файловые операции, внешние API)
- Транзакции БД через Yii::$app->db->beginTransaction() для связанных операций

